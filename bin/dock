#!/usr/bin/env bash

# Defines arguments
ARGS=("$@")

# Check if docker-compose.yml has been created
if [ ! -f ./docker-compose.yml ]; then
  echo "File docker-compose.yml has not been created, run 'artisan dock:install'"
  exit 1
fi

# Check for arguments
if [ ${#ARGS[@]} -eq 0 ]; then
  echo "There are no arguments"
  exit 1
fi

# Initially assuming that some particular container will be run
COMMAND=(docker compose run --rm)

case "$1" in
  composer)
      COMMAND+=(composer)
      # Proxies to composer container
      "${COMMAND[@]}" "${ARGS[@]:1}"
  ;;
  artisan)
      COMMAND+=(artisan)
      # Proxies to artisan container
      "${COMMAND[@]}" "${ARGS[@]:1}"
  ;;
  phpunit)
      COMMAND+=(phpunit)
      # Proxies to phpunit container
      "${COMMAND[@]}" "${ARGS[@]:1}"
  ;;
  npm)
      COMMAND+=(npm)
      # Proxies to npm container
      "${COMMAND[@]}" "${ARGS[@]:1}"
  ;;
  *)
    COMMAND=(docker compose)
    # Proxies to docker compose
    "${COMMAND[@]}" "${ARGS[@]}"
  ;;
esac

exit 0
